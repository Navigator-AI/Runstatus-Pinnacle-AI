Database loading configuration from: ./conf/config.ini
Connecting to PostgreSQL at localhost:5432
2025-06-19 12:14:37 [32minfo[39m: [32mLoading configuration from: /home/vinay/Downloads/c2s_integrate/conf/config.ini[39m
2025-06-19 12:14:37 [32minfo[39m: [32mShell Command Service initialized with Python: python/venv/bin/python[39m
2025-06-19 12:14:37 [32minfo[39m: [32mOrchestrator path: /home/vinay/Downloads/c2s_integrate/python/terminal-mcp-orchestrator/orchestrator.py[39m
2025-06-19 12:14:37 [32minfo[39m: [32mShell Command Service initialized successfully[39m
ChromaDB configuration loaded from config.ini: http://localhost:8000
Loading configuration from: /home/vinay/Downloads/c2s_integrate/conf/config.ini
Checking PostgreSQL database connection
Running database migrations...
Connected to PostgreSQL database: copilot
2025-06-19 12:14:37 [32minfo[39m: [32mLoaded Ollama settings from database[39m
2025-06-19 12:14:37 [32minfo[39m: [32mOllamaService initialized[39m
2025-06-19 12:14:37 [32minfo[39m: [32mOllamaService initialized for MCP routes[39m
2025-06-19 12:14:37 [32minfo[39m: [32mLoaded Ollama settings from database[39m
2025-06-19 12:14:37 [32minfo[39m: [32mOllamaService initialized[39m
Applied migrations: [
  '001_create_users_table.js',
  '002_create_sessions_table.js',
  '003_create_chat_sessions_table.js',
  '004_create_ai_models_table.js',
  '005_add_documents_table.js',
  '006_create_messages_table.js',
  '007_create_dashboard_metrics_table.js',
  '008_create_mcp_connections_table.js',
  '009_create_ollama_settings_table.js',
  '010_create_database_functions_and_triggers.js',
  '011_create_vector_stores_table.js',
  '012_create_document_collections_table.js',
  '013_create_document_chunks_table.js',
  '014_create_rag_settings_table.js',
  '015_create_user_ssh_configurations_table.js',
  '016_create_user_mcp_server_configurations_table.js',
  '017_create_user_ai_rules_table.js',
  '018_create_document_functions.js',
  '019_add_document_collections_foreign_key.js',
  '020_add_messages_document_foreign_key.js',
  '021_create_document_count_table.js',
  '022_create_message_stats_table.js',
  '20230924000000_create_user_ssh_configurations.js',
  '20230924000001_create_user_mcp_server_configurations.js',
  '023_add_predictor_data_to_messages.js'
]
Migration 001_create_users_table.js already applied, skipping
Migration 002_create_sessions_table.js already applied, skipping
Migration 003_create_chat_sessions_table.js already applied, skipping
Migration 004_create_ai_models_table.js already applied, skipping
Migration 005_add_documents_table.js already applied, skipping
Migration 006_create_messages_table.js already applied, skipping
Migration 007_create_dashboard_metrics_table.js already applied, skipping
Migration 008_create_mcp_connections_table.js already applied, skipping
Migration 009_create_ollama_settings_table.js already applied, skipping
Migration 010_create_database_functions_and_triggers.js already applied, skipping
Migration 011_create_vector_stores_table.js already applied, skipping
Migration 012_create_document_collections_table.js already applied, skipping
Migration 013_create_document_chunks_table.js already applied, skipping
Migration 014_create_rag_settings_table.js already applied, skipping
Migration 015_create_user_ssh_configurations_table.js already applied, skipping
Migration 016_create_user_mcp_server_configurations_table.js already applied, skipping
Running migration: 017_add_predictor_data_to_messages.js
Adding predictor_data column to messages table...
Successfully added predictor_data column to messages table
Error running migration 017_add_predictor_data_to_messages.js: error: duplicate key value violates unique constraint "schema_migrations_version_key"
    at /home/vinay/Downloads/c2s_integrate/node_modules/pg-pool/index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async runMigrations (/home/vinay/Downloads/c2s_integrate/src/database.js:319:11)
    at async initializeDatabase (/home/vinay/Downloads/c2s_integrate/src/database.js:123:5)
    at async startServer (/home/vinay/Downloads/c2s_integrate/src/server.js:89:5) {
  length: 237,
  severity: 'ERROR',
  code: '23505',
  detail: 'Key (version)=(017) already exists.',
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: 'public',
  table: 'schema_migrations',
  column: undefined,
  dataType: undefined,
  constraint: 'schema_migrations_version_key',
  file: 'nbtinsert.c',
  line: '666',
  routine: '_bt_check_unique'
}
Error running migrations: error: duplicate key value violates unique constraint "schema_migrations_version_key"
    at /home/vinay/Downloads/c2s_integrate/node_modules/pg-pool/index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async runMigrations (/home/vinay/Downloads/c2s_integrate/src/database.js:319:11)
    at async initializeDatabase (/home/vinay/Downloads/c2s_integrate/src/database.js:123:5)
    at async startServer (/home/vinay/Downloads/c2s_integrate/src/server.js:89:5) {
  length: 237,
  severity: 'ERROR',
  code: '23505',
  detail: 'Key (version)=(017) already exists.',
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: 'public',
  table: 'schema_migrations',
  column: undefined,
  dataType: undefined,
  constraint: 'schema_migrations_version_key',
  file: 'nbtinsert.c',
  line: '666',
  routine: '_bt_check_unique'
}
Database initialization error: error: duplicate key value violates unique constraint "schema_migrations_version_key"
    at /home/vinay/Downloads/c2s_integrate/node_modules/pg-pool/index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async runMigrations (/home/vinay/Downloads/c2s_integrate/src/database.js:319:11)
    at async initializeDatabase (/home/vinay/Downloads/c2s_integrate/src/database.js:123:5)
    at async startServer (/home/vinay/Downloads/c2s_integrate/src/server.js:89:5) {
  length: 237,
  severity: 'ERROR',
  code: '23505',
  detail: 'Key (version)=(017) already exists.',
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: 'public',
  table: 'schema_migrations',
  column: undefined,
  dataType: undefined,
  constraint: 'schema_migrations_version_key',
  file: 'nbtinsert.c',
  line: '666',
  routine: '_bt_check_unique'
}
More details: duplicate key value violates unique constraint "schema_migrations_version_key"
Database initialization completed
Migration script scripts/sql/add_model_id_to_ai_models.sql executed successfully
Model ID migration completed
Setting session store reference for WebSocket authentication
Session store reference set in sessionService
Serving static files from: ./client/build
WebSocket server initialized
2025-06-19 12:14:37 [32minfo[39m: [32mRegistering MCP WebSocket message handlers[39m
Registered message handler for message type: mcp_connect
Registered message handler for message type: mcp_disconnect
Registered message handler for message type: mcp_execute_tool
Set client disconnect callback handler
Registered MCP WebSocket handlers
2025-06-19 12:14:37 [32minfo[39m: [32mLoaded Ollama settings from database[39m
2025-06-19 12:14:37 [32minfo[39m: [32mOllamaService initialized[39m
Server running on http://localhost:5679
WebSocket server running on ws://localhost:5679/ws
Received SIGTERM. Performing graceful shutdown...
Server closed. Exiting process.
Database connection pool closed
